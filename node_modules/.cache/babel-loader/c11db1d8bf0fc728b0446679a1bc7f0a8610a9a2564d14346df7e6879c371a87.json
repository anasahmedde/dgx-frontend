{"ast":null,"code":"// src/api/video.js\nimport httpFactory from \"./httpFactory\";\n\n// Use env if set, else localhost:8003 (matches your curl)\nconst BASE = process.env.REACT_APP_VIDEO_API || \"http://localhost:8003\";\nconst http = httpFactory(BASE);\n\n// --- existing CRUD you already had ---\nexport const insertVideo = (video_name, s3_link) => http.post(\"/insert_video\", {\n  video_name,\n  s3_link\n});\nexport const getVideo = video_name => http.get(`/video/${encodeURIComponent(video_name)}`);\nexport const listVideos = (params = {}) => http.get(\"/videos\", {\n  params\n}); // {q, limit, offset}\n\nexport const updateVideo = (video_name, patch) => http.put(`/video/${encodeURIComponent(video_name)}`, patch); // {video_name?, s3_link?}\n\nexport const deleteVideo = video_name => http.delete(`/video/${encodeURIComponent(video_name)}`);\n\n// --- NEW: upload via multipart/form-data ---\n/**\n * Upload a video file to /upload_video as <video_name>.mp4\n * @param {File} file - browser File object\n * @param {string} video_name - name to save as (without extension)\n * @param {boolean} overwrite - if true, replaces existing S3 object/row\n * @param {(pct:number, loaded:number, total:number)=>void} onProgress - optional progress cb\n */\nexport const uploadVideo = (file, video_name, overwrite = false, onProgress) => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  fd.append(\"video_name\", video_name);\n  if (overwrite) fd.append(\"overwrite\", \"true\");\n  return http.post(\"/upload_video\", fd, {\n    headers: {\n      \"Content-Type\": \"multipart/form-data\"\n    },\n    onUploadProgress: evt => {\n      if (!onProgress || !evt.total) return;\n      const pct = Math.round(evt.loaded / evt.total * 100);\n      onProgress(pct, evt.loaded, evt.total);\n    }\n  });\n};","map":{"version":3,"names":["httpFactory","BASE","process","env","REACT_APP_VIDEO_API","http","insertVideo","video_name","s3_link","post","getVideo","get","encodeURIComponent","listVideos","params","updateVideo","patch","put","deleteVideo","delete","uploadVideo","file","overwrite","onProgress","fd","FormData","append","headers","onUploadProgress","evt","total","pct","Math","round","loaded"],"sources":["/home/ubuntu/loadboard/react-video/src/api/video.js"],"sourcesContent":["// src/api/video.js\nimport httpFactory from \"./httpFactory\";\n\n// Use env if set, else localhost:8003 (matches your curl)\nconst BASE = process.env.REACT_APP_VIDEO_API || \"http://localhost:8003\";\nconst http = httpFactory(BASE);\n\n// --- existing CRUD you already had ---\nexport const insertVideo = (video_name, s3_link) =>\n  http.post(\"/insert_video\", { video_name, s3_link });\n\nexport const getVideo = (video_name) =>\n  http.get(`/video/${encodeURIComponent(video_name)}`);\n\nexport const listVideos = (params = {}) =>\n  http.get(\"/videos\", { params }); // {q, limit, offset}\n\nexport const updateVideo = (video_name, patch) =>\n  http.put(`/video/${encodeURIComponent(video_name)}`, patch); // {video_name?, s3_link?}\n\nexport const deleteVideo = (video_name) =>\n  http.delete(`/video/${encodeURIComponent(video_name)}`);\n\n// --- NEW: upload via multipart/form-data ---\n/**\n * Upload a video file to /upload_video as <video_name>.mp4\n * @param {File} file - browser File object\n * @param {string} video_name - name to save as (without extension)\n * @param {boolean} overwrite - if true, replaces existing S3 object/row\n * @param {(pct:number, loaded:number, total:number)=>void} onProgress - optional progress cb\n */\nexport const uploadVideo = (file, video_name, overwrite = false, onProgress) => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  fd.append(\"video_name\", video_name);\n  if (overwrite) fd.append(\"overwrite\", \"true\");\n\n  return http.post(\"/upload_video\", fd, {\n    headers: { \"Content-Type\": \"multipart/form-data\" },\n    onUploadProgress: (evt) => {\n      if (!onProgress || !evt.total) return;\n      const pct = Math.round((evt.loaded / evt.total) * 100);\n      onProgress(pct, evt.loaded, evt.total);\n    },\n  });\n};\n\n"],"mappings":"AAAA;AACA,OAAOA,WAAW,MAAM,eAAe;;AAEvC;AACA,MAAMC,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,mBAAmB,IAAI,uBAAuB;AACvE,MAAMC,IAAI,GAAGL,WAAW,CAACC,IAAI,CAAC;;AAE9B;AACA,OAAO,MAAMK,WAAW,GAAGA,CAACC,UAAU,EAAEC,OAAO,KAC7CH,IAAI,CAACI,IAAI,CAAC,eAAe,EAAE;EAAEF,UAAU;EAAEC;AAAQ,CAAC,CAAC;AAErD,OAAO,MAAME,QAAQ,GAAIH,UAAU,IACjCF,IAAI,CAACM,GAAG,CAAC,UAAUC,kBAAkB,CAACL,UAAU,CAAC,EAAE,CAAC;AAEtD,OAAO,MAAMM,UAAU,GAAGA,CAACC,MAAM,GAAG,CAAC,CAAC,KACpCT,IAAI,CAACM,GAAG,CAAC,SAAS,EAAE;EAAEG;AAAO,CAAC,CAAC,CAAC,CAAC;;AAEnC,OAAO,MAAMC,WAAW,GAAGA,CAACR,UAAU,EAAES,KAAK,KAC3CX,IAAI,CAACY,GAAG,CAAC,UAAUL,kBAAkB,CAACL,UAAU,CAAC,EAAE,EAAES,KAAK,CAAC,CAAC,CAAC;;AAE/D,OAAO,MAAME,WAAW,GAAIX,UAAU,IACpCF,IAAI,CAACc,MAAM,CAAC,UAAUP,kBAAkB,CAACL,UAAU,CAAC,EAAE,CAAC;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMa,WAAW,GAAGA,CAACC,IAAI,EAAEd,UAAU,EAAEe,SAAS,GAAG,KAAK,EAAEC,UAAU,KAAK;EAC9E,MAAMC,EAAE,GAAG,IAAIC,QAAQ,CAAC,CAAC;EACzBD,EAAE,CAACE,MAAM,CAAC,MAAM,EAAEL,IAAI,CAAC;EACvBG,EAAE,CAACE,MAAM,CAAC,YAAY,EAAEnB,UAAU,CAAC;EACnC,IAAIe,SAAS,EAAEE,EAAE,CAACE,MAAM,CAAC,WAAW,EAAE,MAAM,CAAC;EAE7C,OAAOrB,IAAI,CAACI,IAAI,CAAC,eAAe,EAAEe,EAAE,EAAE;IACpCG,OAAO,EAAE;MAAE,cAAc,EAAE;IAAsB,CAAC;IAClDC,gBAAgB,EAAGC,GAAG,IAAK;MACzB,IAAI,CAACN,UAAU,IAAI,CAACM,GAAG,CAACC,KAAK,EAAE;MAC/B,MAAMC,GAAG,GAAGC,IAAI,CAACC,KAAK,CAAEJ,GAAG,CAACK,MAAM,GAAGL,GAAG,CAACC,KAAK,GAAI,GAAG,CAAC;MACtDP,UAAU,CAACQ,GAAG,EAAEF,GAAG,CAACK,MAAM,EAAEL,GAAG,CAACC,KAAK,CAAC;IACxC;EACF,CAAC,CAAC;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
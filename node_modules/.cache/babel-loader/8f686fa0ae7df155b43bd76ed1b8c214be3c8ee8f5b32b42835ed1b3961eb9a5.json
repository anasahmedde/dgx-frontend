{"ast":null,"code":"import axios from \"axios\";\n\n/**\n * API configuration\n */\nconst DEFAULT_BASE = process.env.REACT_APP_API_BASE_URL || `${window.location.protocol}//${window.location.hostname}:8005`;\nexport const api = axios.create({\n  baseURL: DEFAULT_BASE,\n  timeout: 30000,\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n});\n\n// Optional auth support\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\");\n  if (token) config.headers.Authorization = `Bearer ${token}`;\n  return config;\n});\nfunction unwrapAxiosError(err) {\n  var _err$response, _err$response2;\n  const status = err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status;\n  const data = err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data;\n  const message = (data === null || data === void 0 ? void 0 : data.detail) || (data === null || data === void 0 ? void 0 : data.message) || (err === null || err === void 0 ? void 0 : err.message) || \"Request failed (unknown error)\";\n  return {\n    status,\n    data,\n    message,\n    raw: err\n  };\n}\nexport async function safeGet(url, params) {\n  try {\n    const res = await api.get(url, {\n      params\n    });\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    return {\n      ok: false,\n      ...unwrapAxiosError(err)\n    };\n  }\n}\nexport async function safePost(url, body) {\n  try {\n    const res = await api.post(url, body);\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    return {\n      ok: false,\n      ...unwrapAxiosError(err)\n    };\n  }\n}\nexport async function safePut(url, body) {\n  try {\n    const res = await api.put(url, body);\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    return {\n      ok: false,\n      ...unwrapAxiosError(err)\n    };\n  }\n}\nexport async function safeDelete(url) {\n  try {\n    const res = await api.delete(url);\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    return {\n      ok: false,\n      ...unwrapAxiosError(err)\n    };\n  }\n}\n\n/**\n * Fallback POST: tries paths in order until one works\n */\nexport async function safePostFallback(paths, body) {\n  let last = null;\n  for (const p of paths) {\n    const r = await safePost(p, body);\n    if (r.ok) return r;\n    if ([404, 405].includes(r.status)) {\n      last = r;\n      continue;\n    }\n    return r;\n  }\n  return last || {\n    ok: false,\n    status: 0,\n    message: \"All fallback POST endpoints failed\"\n  };\n}\n\n/**\n * Normalizes list responses into { items, total }\n */\nexport function normalizeList(payload) {\n  var _ref, _data$total;\n  const data = payload !== null && payload !== void 0 ? payload : {};\n  const items = Array.isArray(data) ? data : data.items || data.data || data.results || [];\n  const total = (_ref = (_data$total = data.total) !== null && _data$total !== void 0 ? _data$total : data.count) !== null && _ref !== void 0 ? _ref : Array.isArray(items) ? items.length : 0;\n  return {\n    items: Array.isArray(items) ? items : [],\n    total\n  };\n}\n\n/**\n * Upload file with progress callback\n */\nexport async function uploadWithProgress(url, formData, onProgress) {\n  try {\n    const res = await api.post(url, formData, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      },\n      onUploadProgress: progressEvent => {\n        if (onProgress && progressEvent.total) {\n          const percent = Math.round(progressEvent.loaded * 100 / progressEvent.total);\n          onProgress(percent);\n        }\n      }\n    });\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    return {\n      ok: false,\n      ...unwrapAxiosError(err)\n    };\n  }\n}\n\n/**\n * OLD PATTERN SUPPORT - httpFactory function for dvsg.js compatibility\n * Creates an axios-like instance with custom baseURL\n */\nexport function httpFactory({\n  baseURL\n} = {}) {\n  const instance = axios.create({\n    baseURL: baseURL || DEFAULT_BASE,\n    timeout: 30000,\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n\n  // Add auth interceptor\n  instance.interceptors.request.use(config => {\n    const token = localStorage.getItem(\"token\");\n    if (token) config.headers.Authorization = `Bearer ${token}`;\n    return config;\n  });\n  return instance;\n}","map":{"version":3,"names":["axios","DEFAULT_BASE","process","env","REACT_APP_API_BASE_URL","window","location","protocol","hostname","api","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","unwrapAxiosError","err","_err$response","_err$response2","status","response","data","message","detail","raw","safeGet","url","params","res","get","ok","safePost","body","post","safePut","put","safeDelete","delete","safePostFallback","paths","last","p","r","includes","normalizeList","payload","_ref","_data$total","items","Array","isArray","results","total","count","length","uploadWithProgress","formData","onProgress","onUploadProgress","progressEvent","percent","Math","round","loaded","httpFactory","instance"],"sources":["/home/ubuntu/loadboard/react-video/src/api/httpFactory.js"],"sourcesContent":["import axios from \"axios\";\n\n/**\n * API configuration\n */\nconst DEFAULT_BASE =\n  process.env.REACT_APP_API_BASE_URL ||\n  `${window.location.protocol}//${window.location.hostname}:8005`;\n\nexport const api = axios.create({\n  baseURL: DEFAULT_BASE,\n  timeout: 30000,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n});\n\n// Optional auth support\napi.interceptors.request.use((config) => {\n  const token = localStorage.getItem(\"token\");\n  if (token) config.headers.Authorization = `Bearer ${token}`;\n  return config;\n});\n\nfunction unwrapAxiosError(err) {\n  const status = err?.response?.status;\n  const data = err?.response?.data;\n  const message =\n    data?.detail ||\n    data?.message ||\n    err?.message ||\n    \"Request failed (unknown error)\";\n  return { status, data, message, raw: err };\n}\n\nexport async function safeGet(url, params) {\n  try {\n    const res = await api.get(url, { params });\n    return { ok: true, data: res.data };\n  } catch (err) {\n    return { ok: false, ...unwrapAxiosError(err) };\n  }\n}\n\nexport async function safePost(url, body) {\n  try {\n    const res = await api.post(url, body);\n    return { ok: true, data: res.data };\n  } catch (err) {\n    return { ok: false, ...unwrapAxiosError(err) };\n  }\n}\n\nexport async function safePut(url, body) {\n  try {\n    const res = await api.put(url, body);\n    return { ok: true, data: res.data };\n  } catch (err) {\n    return { ok: false, ...unwrapAxiosError(err) };\n  }\n}\n\nexport async function safeDelete(url) {\n  try {\n    const res = await api.delete(url);\n    return { ok: true, data: res.data };\n  } catch (err) {\n    return { ok: false, ...unwrapAxiosError(err) };\n  }\n}\n\n/**\n * Fallback POST: tries paths in order until one works\n */\nexport async function safePostFallback(paths, body) {\n  let last = null;\n\n  for (const p of paths) {\n    const r = await safePost(p, body);\n    if (r.ok) return r;\n\n    if ([404, 405].includes(r.status)) {\n      last = r;\n      continue;\n    }\n\n    return r;\n  }\n\n  return (\n    last || {\n      ok: false,\n      status: 0,\n      message: \"All fallback POST endpoints failed\",\n    }\n  );\n}\n\n/**\n * Normalizes list responses into { items, total }\n */\nexport function normalizeList(payload) {\n  const data = payload ?? {};\n  const items =\n    Array.isArray(data) ? data : data.items || data.data || data.results || [];\n  const total = data.total ?? data.count ?? (Array.isArray(items) ? items.length : 0);\n  return { items: Array.isArray(items) ? items : [], total };\n}\n\n/**\n * Upload file with progress callback\n */\nexport async function uploadWithProgress(url, formData, onProgress) {\n  try {\n    const res = await api.post(url, formData, {\n      headers: { \"Content-Type\": \"multipart/form-data\" },\n      onUploadProgress: (progressEvent) => {\n        if (onProgress && progressEvent.total) {\n          const percent = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n          onProgress(percent);\n        }\n      },\n    });\n    return { ok: true, data: res.data };\n  } catch (err) {\n    return { ok: false, ...unwrapAxiosError(err) };\n  }\n}\n\n/**\n * OLD PATTERN SUPPORT - httpFactory function for dvsg.js compatibility\n * Creates an axios-like instance with custom baseURL\n */\nexport function httpFactory({ baseURL } = {}) {\n  const instance = axios.create({\n    baseURL: baseURL || DEFAULT_BASE,\n    timeout: 30000,\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  });\n\n  // Add auth interceptor\n  instance.interceptors.request.use((config) => {\n    const token = localStorage.getItem(\"token\");\n    if (token) config.headers.Authorization = `Bearer ${token}`;\n    return config;\n  });\n\n  return instance;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
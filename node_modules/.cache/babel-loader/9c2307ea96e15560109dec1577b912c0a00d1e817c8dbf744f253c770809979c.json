{"ast":null,"code":"// src/components/Linker.js\nimport React, { useEffect, useState } from \"react\";\nimport { listDevices } from \"../api/device\";\nimport { listGroups } from \"../api/group\";\nimport { listShops } from \"../api/shop\";\nimport { listVideos } from \"../api/video\";\nimport { createLink, listLinks, deleteLink } from \"../api/link\";\nexport default function Linker({\n  onChanged\n}) {\n  // <-- accept callback\n  // ... (unchanged state)\n\n  // withLimitFallback + loadAll unchanged except for MAX=100 and defaults\n\n  const add = async () => {\n    if (!mobileId || !gname || !shopName || !videoName) {\n      setMsg(\"Please select Device, Group, Shop, and Video.\");\n      return;\n    }\n    setBusy(true);\n    setMsg(\"\");\n    try {\n      await createLink({\n        mobile_id: mobileId,\n        gname,\n        shop_name: shopName,\n        video_name: videoName\n      });\n      setMsg(\"Link created ✅\");\n      clear();\n      const l = await listLinks({\n        limit: 50,\n        offset: 0\n      });\n      setLinks(l.data.items || []);\n      onChanged && onChanged(); // <-- notify\n    } catch (e) {\n      var _e$response, _e$response$data;\n      setMsg(`Failed: ${(e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.detail) || e.message}`);\n    } finally {\n      setBusy(false);\n    }\n  };\n  const remove = async id => {\n    if (!window.confirm(\"Delete this link?\")) return;\n    setBusy(true);\n    try {\n      await deleteLink(id);\n      setLinks(x => x.filter(r => r.id !== id));\n      onChanged && onChanged(); // <-- notify\n    } catch (e) {\n      var _e$response2, _e$response2$data;\n      setMsg(`Delete failed: ${(e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.detail) || e.message}`);\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  // ... rest of the component (UI/styles) stays the same as you have now\n}\n_c = Linker;\nvar _c;\n$RefreshReg$(_c, \"Linker\");","map":{"version":3,"names":["React","useEffect","useState","listDevices","listGroups","listShops","listVideos","createLink","listLinks","deleteLink","Linker","onChanged","add","mobileId","gname","shopName","videoName","setMsg","setBusy","mobile_id","shop_name","video_name","clear","l","limit","offset","setLinks","data","items","e","_e$response","_e$response$data","response","detail","message","remove","id","window","confirm","x","filter","r","_e$response2","_e$response2$data","_c","$RefreshReg$"],"sources":["/home/azherahmed/Documents/azhar/videproject/frontend/react-video/src/components/Linker.js"],"sourcesContent":["// src/components/Linker.js\nimport React, { useEffect, useState } from \"react\";\nimport { listDevices } from \"../api/device\";\nimport { listGroups } from \"../api/group\";\nimport { listShops } from \"../api/shop\";\nimport { listVideos } from \"../api/video\";\nimport { createLink, listLinks, deleteLink } from \"../api/link\";\n\nexport default function Linker({ onChanged }) {          // <-- accept callback\n  // ... (unchanged state)\n\n  // withLimitFallback + loadAll unchanged except for MAX=100 and defaults\n\n  const add = async () => {\n    if (!mobileId || !gname || !shopName || !videoName) {\n      setMsg(\"Please select Device, Group, Shop, and Video.\");\n      return;\n    }\n    setBusy(true);\n    setMsg(\"\");\n    try {\n      await createLink({\n        mobile_id: mobileId,\n        gname,\n        shop_name: shopName,\n        video_name: videoName,\n      });\n      setMsg(\"Link created ✅\");\n      clear();\n      const l = await listLinks({ limit: 50, offset: 0 });\n      setLinks(l.data.items || []);\n      onChanged && onChanged();                           // <-- notify\n    } catch (e) {\n      setMsg(`Failed: ${e?.response?.data?.detail || e.message}`);\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  const remove = async (id) => {\n    if (!window.confirm(\"Delete this link?\")) return;\n    setBusy(true);\n    try {\n      await deleteLink(id);\n      setLinks((x) => x.filter((r) => r.id !== id));\n      onChanged && onChanged();                           // <-- notify\n    } catch (e) {\n      setMsg(`Delete failed: ${e?.response?.data?.detail || e.message}`);\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  // ... rest of the component (UI/styles) stays the same as you have now\n}\n\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,eAAe;AAC3C,SAASC,UAAU,QAAQ,cAAc;AACzC,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,UAAU,QAAQ,cAAc;AACzC,SAASC,UAAU,EAAEC,SAAS,EAAEC,UAAU,QAAQ,aAAa;AAE/D,eAAe,SAASC,MAAMA,CAAC;EAAEC;AAAU,CAAC,EAAE;EAAW;EACvD;;EAEA;;EAEA,MAAMC,GAAG,GAAG,MAAAA,CAAA,KAAY;IACtB,IAAI,CAACC,QAAQ,IAAI,CAACC,KAAK,IAAI,CAACC,QAAQ,IAAI,CAACC,SAAS,EAAE;MAClDC,MAAM,CAAC,+CAA+C,CAAC;MACvD;IACF;IACAC,OAAO,CAAC,IAAI,CAAC;IACbD,MAAM,CAAC,EAAE,CAAC;IACV,IAAI;MACF,MAAMV,UAAU,CAAC;QACfY,SAAS,EAAEN,QAAQ;QACnBC,KAAK;QACLM,SAAS,EAAEL,QAAQ;QACnBM,UAAU,EAAEL;MACd,CAAC,CAAC;MACFC,MAAM,CAAC,gBAAgB,CAAC;MACxBK,KAAK,CAAC,CAAC;MACP,MAAMC,CAAC,GAAG,MAAMf,SAAS,CAAC;QAAEgB,KAAK,EAAE,EAAE;QAAEC,MAAM,EAAE;MAAE,CAAC,CAAC;MACnDC,QAAQ,CAACH,CAAC,CAACI,IAAI,CAACC,KAAK,IAAI,EAAE,CAAC;MAC5BjB,SAAS,IAAIA,SAAS,CAAC,CAAC,CAAC,CAA2B;IACtD,CAAC,CAAC,OAAOkB,CAAC,EAAE;MAAA,IAAAC,WAAA,EAAAC,gBAAA;MACVd,MAAM,CAAC,WAAW,CAAAY,CAAC,aAADA,CAAC,wBAAAC,WAAA,GAADD,CAAC,CAAEG,QAAQ,cAAAF,WAAA,wBAAAC,gBAAA,GAAXD,WAAA,CAAaH,IAAI,cAAAI,gBAAA,uBAAjBA,gBAAA,CAAmBE,MAAM,KAAIJ,CAAC,CAACK,OAAO,EAAE,CAAC;IAC7D,CAAC,SAAS;MACRhB,OAAO,CAAC,KAAK,CAAC;IAChB;EACF,CAAC;EAED,MAAMiB,MAAM,GAAG,MAAOC,EAAE,IAAK;IAC3B,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,mBAAmB,CAAC,EAAE;IAC1CpB,OAAO,CAAC,IAAI,CAAC;IACb,IAAI;MACF,MAAMT,UAAU,CAAC2B,EAAE,CAAC;MACpBV,QAAQ,CAAEa,CAAC,IAAKA,CAAC,CAACC,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACL,EAAE,KAAKA,EAAE,CAAC,CAAC;MAC7CzB,SAAS,IAAIA,SAAS,CAAC,CAAC,CAAC,CAA2B;IACtD,CAAC,CAAC,OAAOkB,CAAC,EAAE;MAAA,IAAAa,YAAA,EAAAC,iBAAA;MACV1B,MAAM,CAAC,kBAAkB,CAAAY,CAAC,aAADA,CAAC,wBAAAa,YAAA,GAADb,CAAC,CAAEG,QAAQ,cAAAU,YAAA,wBAAAC,iBAAA,GAAXD,YAAA,CAAaf,IAAI,cAAAgB,iBAAA,uBAAjBA,iBAAA,CAAmBV,MAAM,KAAIJ,CAAC,CAACK,OAAO,EAAE,CAAC;IACpE,CAAC,SAAS;MACRhB,OAAO,CAAC,KAAK,CAAC;IAChB;EACF,CAAC;;EAED;AACF;AAAC0B,EAAA,GA9CuBlC,MAAM;AAAA,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"// src/api/video.js\nimport httpFactory from \"./httpFactory\";\nconst BASE = process.env.REACT_APP_VIDEO_API || \"http://34.248.112.237:8003\";\nconst http = httpFactory(BASE);\n\n/** Create/insert a DB row manually */\nexport const insertVideo = (video_name, s3_link) => http.post(\"/insert_video\", {\n  video_name,\n  s3_link\n});\n\n/** Read one row */\nexport const getVideo = video_name => http.get(`/video/${encodeURIComponent(video_name)}`);\n\n/** List (supports { q, limit, offset }) */\nexport const listVideos = (params = {}) => http.get(\"/videos\", {\n  params\n});\n\n/** Update */\nexport const updateVideo = (video_name, patch) => http.put(`/video/${encodeURIComponent(video_name)}`, patch);\n\n/** Delete */\nexport const deleteVideo = video_name => http.delete(`/video/${encodeURIComponent(video_name)}`);\n\n/** Upload a file via multipart to /upload_video as <video_name>.mp4 */\nexport const uploadVideo = (file, video_name, overwrite = false, onProgress) => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  fd.append(\"video_name\", video_name);\n  if (overwrite) fd.append(\"overwrite\", \"true\");\n  return http.post(\"/upload_video\", fd, {\n    headers: {\n      \"Content-Type\": \"multipart/form-data\"\n    },\n    onUploadProgress: evt => {\n      if (!onProgress || !evt.total) return;\n      const pct = Math.round(evt.loaded / evt.total * 100);\n      onProgress(pct, evt.loaded, evt.total);\n    }\n  });\n};\n\n/* ---------------- Optional helpers for Autocomplete ---------------- */\n\nexport const listVideosSafe = async (params = {}) => {\n  const caps = [200, 100, 50];\n  for (const cap of caps) {\n    try {\n      return await listVideos({\n        limit: cap,\n        offset: 0,\n        ...params\n      });\n    } catch (e) {\n      var _e$response;\n      if ((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status) !== 422) throw e;\n    }\n  }\n  return listVideos();\n};\nexport const listVideoNames = async (params = {}) => {\n  var _r$data;\n  const r = await listVideosSafe(params);\n  return (((_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.items) || []).map(x => x === null || x === void 0 ? void 0 : x.video_name).filter(Boolean);\n};","map":{"version":3,"names":["httpFactory","BASE","process","env","REACT_APP_VIDEO_API","http","insertVideo","video_name","s3_link","post","getVideo","get","encodeURIComponent","listVideos","params","updateVideo","patch","put","deleteVideo","delete","uploadVideo","file","overwrite","onProgress","fd","FormData","append","headers","onUploadProgress","evt","total","pct","Math","round","loaded","listVideosSafe","caps","cap","limit","offset","e","_e$response","response","status","listVideoNames","_r$data","r","data","items","map","x","filter","Boolean"],"sources":["/home/ubuntu/loadboard/react-video/src/api/video.js"],"sourcesContent":["// src/api/video.js\nimport httpFactory from \"./httpFactory\";\n\nconst BASE = process.env.REACT_APP_VIDEO_API || \"http://34.248.112.237:8003\";\nconst http = httpFactory(BASE);\n\n/** Create/insert a DB row manually */\nexport const insertVideo = (video_name, s3_link) =>\n  http.post(\"/insert_video\", { video_name, s3_link });\n\n/** Read one row */\nexport const getVideo = (video_name) =>\n  http.get(`/video/${encodeURIComponent(video_name)}`);\n\n/** List (supports { q, limit, offset }) */\nexport const listVideos = (params = {}) =>\n  http.get(\"/videos\", { params });\n\n/** Update */\nexport const updateVideo = (video_name, patch) =>\n  http.put(`/video/${encodeURIComponent(video_name)}`, patch);\n\n/** Delete */\nexport const deleteVideo = (video_name) =>\n  http.delete(`/video/${encodeURIComponent(video_name)}`);\n\n/** Upload a file via multipart to /upload_video as <video_name>.mp4 */\nexport const uploadVideo = (file, video_name, overwrite = false, onProgress) => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  fd.append(\"video_name\", video_name);\n  if (overwrite) fd.append(\"overwrite\", \"true\");\n\n  return http.post(\"/upload_video\", fd, {\n    headers: { \"Content-Type\": \"multipart/form-data\" },\n    onUploadProgress: (evt) => {\n      if (!onProgress || !evt.total) return;\n      const pct = Math.round((evt.loaded / evt.total) * 100);\n      onProgress(pct, evt.loaded, evt.total);\n    },\n  });\n};\n\n/* ---------------- Optional helpers for Autocomplete ---------------- */\n\nexport const listVideosSafe = async (params = {}) => {\n  const caps = [200, 100, 50];\n  for (const cap of caps) {\n    try {\n      return await listVideos({ limit: cap, offset: 0, ...params });\n    } catch (e) {\n      if (e?.response?.status !== 422) throw e;\n    }\n  }\n  return listVideos();\n};\n\nexport const listVideoNames = async (params = {}) => {\n  const r = await listVideosSafe(params);\n  return (r.data?.items || []).map((x) => x?.video_name).filter(Boolean);\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
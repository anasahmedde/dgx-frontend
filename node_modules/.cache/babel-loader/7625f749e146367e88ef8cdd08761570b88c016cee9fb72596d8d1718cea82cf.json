{"ast":null,"code":"// src/api/shop.js\nimport httpFactory from \"./httpFactory\";\n\n// Use env first, fallback to your current host:port\nconst BASE = process.env.REACT_APP_SHOP_API || \"http://34.248.112.237:8002\";\nconst http = httpFactory(BASE);\n\n/** Create */\nexport const insertShop = shop_name => http.post(\"/insert_shop\", {\n  shop_name\n});\n\n/** Read one */\nexport const getShop = shop_name => http.get(`/shop/${encodeURIComponent(shop_name)}`);\n\n/** List (supports { q, limit, offset }) */\nexport const listShops = (params = {}) => http.get(\"/shops\", {\n  params\n});\n\n/** Update */\nexport const updateShop = (shop_name, patch) => http.put(`/shop/${encodeURIComponent(shop_name)}`, patch);\n\n/** Delete */\nexport const deleteShop = shop_name => http.delete(`/shop/${encodeURIComponent(shop_name)}`);\n\n/* ---------------- Optional helpers for Autocomplete ---------------- */\n\n/**\n * listShopsSafe: try a high limit then gracefully fall back on 422.\n * Returns Axios response (same shape as listShops).\n */\nexport const listShopsSafe = async (params = {}) => {\n  const caps = [200, 100, 50];\n  for (const cap of caps) {\n    try {\n      return await listShops({\n        limit: cap,\n        offset: 0,\n        ...params\n      });\n    } catch (e) {\n      var _e$response;\n      if ((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status) !== 422) throw e;\n    }\n  }\n  return listShops(); // final attempt with API defaults\n};\n\n/**\n * listShopNames: convenience to get an array of strings (shop_name)\n */\nexport const listShopNames = async (params = {}) => {\n  var _r$data;\n  const r = await listShopsSafe(params);\n  return (((_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.items) || []).map(x => x === null || x === void 0 ? void 0 : x.shop_name).filter(Boolean);\n};","map":{"version":3,"names":["httpFactory","BASE","process","env","REACT_APP_SHOP_API","http","insertShop","shop_name","post","getShop","get","encodeURIComponent","listShops","params","updateShop","patch","put","deleteShop","delete","listShopsSafe","caps","cap","limit","offset","e","_e$response","response","status","listShopNames","_r$data","r","data","items","map","x","filter","Boolean"],"sources":["/home/ubuntu/loadboard/react-video/src/api/shop.js"],"sourcesContent":["// src/api/shop.js\nimport httpFactory from \"./httpFactory\";\n\n// Use env first, fallback to your current host:port\nconst BASE = process.env.REACT_APP_SHOP_API || \"http://34.248.112.237:8002\";\nconst http = httpFactory(BASE);\n\n/** Create */\nexport const insertShop = (shop_name) =>\n  http.post(\"/insert_shop\", { shop_name });\n\n/** Read one */\nexport const getShop = (shop_name) =>\n  http.get(`/shop/${encodeURIComponent(shop_name)}`);\n\n/** List (supports { q, limit, offset }) */\nexport const listShops = (params = {}) =>\n  http.get(\"/shops\", { params });\n\n/** Update */\nexport const updateShop = (shop_name, patch) =>\n  http.put(`/shop/${encodeURIComponent(shop_name)}`, patch);\n\n/** Delete */\nexport const deleteShop = (shop_name) =>\n  http.delete(`/shop/${encodeURIComponent(shop_name)}`);\n\n/* ---------------- Optional helpers for Autocomplete ---------------- */\n\n/**\n * listShopsSafe: try a high limit then gracefully fall back on 422.\n * Returns Axios response (same shape as listShops).\n */\nexport const listShopsSafe = async (params = {}) => {\n  const caps = [200, 100, 50];\n  for (const cap of caps) {\n    try {\n      return await listShops({ limit: cap, offset: 0, ...params });\n    } catch (e) {\n      if (e?.response?.status !== 422) throw e;\n    }\n  }\n  return listShops(); // final attempt with API defaults\n};\n\n/**\n * listShopNames: convenience to get an array of strings (shop_name)\n */\nexport const listShopNames = async (params = {}) => {\n  const r = await listShopsSafe(params);\n  return (r.data?.items || []).map((x) => x?.shop_name).filter(Boolean);\n};\n\n"],"mappings":"AAAA;AACA,OAAOA,WAAW,MAAM,eAAe;;AAEvC;AACA,MAAMC,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,4BAA4B;AAC3E,MAAMC,IAAI,GAAGL,WAAW,CAACC,IAAI,CAAC;;AAE9B;AACA,OAAO,MAAMK,UAAU,GAAIC,SAAS,IAClCF,IAAI,CAACG,IAAI,CAAC,cAAc,EAAE;EAAED;AAAU,CAAC,CAAC;;AAE1C;AACA,OAAO,MAAME,OAAO,GAAIF,SAAS,IAC/BF,IAAI,CAACK,GAAG,CAAC,SAASC,kBAAkB,CAACJ,SAAS,CAAC,EAAE,CAAC;;AAEpD;AACA,OAAO,MAAMK,SAAS,GAAGA,CAACC,MAAM,GAAG,CAAC,CAAC,KACnCR,IAAI,CAACK,GAAG,CAAC,QAAQ,EAAE;EAAEG;AAAO,CAAC,CAAC;;AAEhC;AACA,OAAO,MAAMC,UAAU,GAAGA,CAACP,SAAS,EAAEQ,KAAK,KACzCV,IAAI,CAACW,GAAG,CAAC,SAASL,kBAAkB,CAACJ,SAAS,CAAC,EAAE,EAAEQ,KAAK,CAAC;;AAE3D;AACA,OAAO,MAAME,UAAU,GAAIV,SAAS,IAClCF,IAAI,CAACa,MAAM,CAAC,SAASP,kBAAkB,CAACJ,SAAS,CAAC,EAAE,CAAC;;AAEvD;;AAEA;AACA;AACA;AACA;AACA,OAAO,MAAMY,aAAa,GAAG,MAAAA,CAAON,MAAM,GAAG,CAAC,CAAC,KAAK;EAClD,MAAMO,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;EAC3B,KAAK,MAAMC,GAAG,IAAID,IAAI,EAAE;IACtB,IAAI;MACF,OAAO,MAAMR,SAAS,CAAC;QAAEU,KAAK,EAAED,GAAG;QAAEE,MAAM,EAAE,CAAC;QAAE,GAAGV;MAAO,CAAC,CAAC;IAC9D,CAAC,CAAC,OAAOW,CAAC,EAAE;MAAA,IAAAC,WAAA;MACV,IAAI,CAAAD,CAAC,aAADA,CAAC,wBAAAC,WAAA,GAADD,CAAC,CAAEE,QAAQ,cAAAD,WAAA,uBAAXA,WAAA,CAAaE,MAAM,MAAK,GAAG,EAAE,MAAMH,CAAC;IAC1C;EACF;EACA,OAAOZ,SAAS,CAAC,CAAC,CAAC,CAAC;AACtB,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMgB,aAAa,GAAG,MAAAA,CAAOf,MAAM,GAAG,CAAC,CAAC,KAAK;EAAA,IAAAgB,OAAA;EAClD,MAAMC,CAAC,GAAG,MAAMX,aAAa,CAACN,MAAM,CAAC;EACrC,OAAO,CAAC,EAAAgB,OAAA,GAAAC,CAAC,CAACC,IAAI,cAAAF,OAAA,uBAANA,OAAA,CAAQG,KAAK,KAAI,EAAE,EAAEC,GAAG,CAAEC,CAAC,IAAKA,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAE3B,SAAS,CAAC,CAAC4B,MAAM,CAACC,OAAO,CAAC;AACvE,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
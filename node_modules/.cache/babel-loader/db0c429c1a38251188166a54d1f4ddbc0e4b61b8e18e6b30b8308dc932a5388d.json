{"ast":null,"code":"// src/api/link.js\nimport { safeGet, safePostFallback, safeDelete, normalizeList } from \"./httpFactory\";\n\n/**\n * List links (supports being called either as:\n *   listLinks(1000, 0)\n * OR\n *   listLinks({ limit: 1000, offset: 0 })\n */\nexport async function listLinks(limitOrOpts = 1000, offset = 0) {\n  var _opts$limit, _opts$offset;\n  const opts = typeof limitOrOpts === \"object\" && limitOrOpts !== null ? limitOrOpts : {\n    limit: limitOrOpts,\n    offset\n  };\n  const limit = Number((_opts$limit = opts.limit) !== null && _opts$limit !== void 0 ? _opts$limit : 1000);\n  const off = Number((_opts$offset = opts.offset) !== null && _opts$offset !== void 0 ? _opts$offset : 0);\n  const r = await safeGet(\"/links\", {\n    limit,\n    offset: off\n  });\n  if (!r.ok) return {\n    ok: false,\n    items: [],\n    total: 0,\n    error: r\n  };\n  const {\n    items,\n    total\n  } = normalizeList(r.data);\n  return {\n    ok: true,\n    items,\n    total,\n    data: r.data\n  };\n}\nexport async function createLinkSafe(payload) {\n  return safePostFallback([\"/link\", \"/links/create\", \"/links\"], payload);\n}\n\n// Backward compatible (your old code imported createLink)\nexport async function createLink(payload) {\n  return createLinkSafe(payload);\n}\nexport async function deleteLink(id) {\n  if (!id) return {\n    ok: false,\n    status: 400,\n    message: \"Missing link id\"\n  };\n  return safeDelete(`/link/${encodeURIComponent(id)}`);\n}\n\n/**\n * ✅ THIS FIXES YOUR BUILD ERROR:\n * dvsg backend has: GET /group/{gname}/videos\n */\nexport async function listGroupVideosByName(gname) {\n  const name = (gname !== null && gname !== void 0 ? gname : \"\").toString().trim();\n  if (!name) return {\n    ok: false,\n    status: 400,\n    message: \"Missing group name\"\n  };\n  return safeGet(`/group/${encodeURIComponent(name)}/videos`);\n}\n\n/**\n * Device online status (DVSG service)\n */\nexport async function getDeviceOnlineStatus(mobileId) {\n  var _ref, _r$data$is_online, _r$data, _r$data2;\n  if (!mobileId) {\n    return {\n      ok: true,\n      data: {\n        mobile_id: \"\",\n        is_online: false\n      }\n    };\n  }\n  const r = await safeGet(`/device/${encodeURIComponent(mobileId)}/online`);\n  if (!r.ok) return r;\n  const is_online = !!((_ref = (_r$data$is_online = (_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.is_online) !== null && _r$data$is_online !== void 0 ? _r$data$is_online : (_r$data2 = r.data) === null || _r$data2 === void 0 ? void 0 : _r$data2.online) !== null && _ref !== void 0 ? _ref : r.data === true);\n  const base = r.data && typeof r.data === \"object\" ? r.data : {};\n  return {\n    ok: true,\n    data: {\n      ...base,\n      is_online\n    }\n  };\n}","map":{"version":3,"names":["safeGet","safePostFallback","safeDelete","normalizeList","listLinks","limitOrOpts","offset","_opts$limit","_opts$offset","opts","limit","Number","off","r","ok","items","total","error","data","createLinkSafe","payload","createLink","deleteLink","id","status","message","encodeURIComponent","listGroupVideosByName","gname","name","toString","trim","getDeviceOnlineStatus","mobileId","_ref","_r$data$is_online","_r$data","_r$data2","mobile_id","is_online","online","base"],"sources":["/home/ubuntu/loadboard/react-video/src/api/link.js"],"sourcesContent":["// src/api/link.js\nimport { safeGet, safePostFallback, safeDelete, normalizeList } from \"./httpFactory\";\n\n/**\n * List links (supports being called either as:\n *   listLinks(1000, 0)\n * OR\n *   listLinks({ limit: 1000, offset: 0 })\n */\nexport async function listLinks(limitOrOpts = 1000, offset = 0) {\n  const opts =\n    typeof limitOrOpts === \"object\" && limitOrOpts !== null\n      ? limitOrOpts\n      : { limit: limitOrOpts, offset };\n\n  const limit = Number(opts.limit ?? 1000);\n  const off = Number(opts.offset ?? 0);\n\n  const r = await safeGet(\"/links\", { limit, offset: off });\n  if (!r.ok) return { ok: false, items: [], total: 0, error: r };\n\n  const { items, total } = normalizeList(r.data);\n  return { ok: true, items, total, data: r.data };\n}\n\nexport async function createLinkSafe(payload) {\n  return safePostFallback([\"/link\", \"/links/create\", \"/links\"], payload);\n}\n\n// Backward compatible (your old code imported createLink)\nexport async function createLink(payload) {\n  return createLinkSafe(payload);\n}\n\nexport async function deleteLink(id) {\n  if (!id) return { ok: false, status: 400, message: \"Missing link id\" };\n  return safeDelete(`/link/${encodeURIComponent(id)}`);\n}\n\n/**\n * ✅ THIS FIXES YOUR BUILD ERROR:\n * dvsg backend has: GET /group/{gname}/videos\n */\nexport async function listGroupVideosByName(gname) {\n  const name = (gname ?? \"\").toString().trim();\n  if (!name) return { ok: false, status: 400, message: \"Missing group name\" };\n  return safeGet(`/group/${encodeURIComponent(name)}/videos`);\n}\n\n/**\n * Device online status (DVSG service)\n */\nexport async function getDeviceOnlineStatus(mobileId) {\n  if (!mobileId) {\n    return { ok: true, data: { mobile_id: \"\", is_online: false } };\n  }\n\n  const r = await safeGet(`/device/${encodeURIComponent(mobileId)}/online`);\n  if (!r.ok) return r;\n\n  const is_online = !!(r.data?.is_online ?? r.data?.online ?? r.data === true);\n  const base = r.data && typeof r.data === \"object\" ? r.data : {};\n  return { ok: true, data: { ...base, is_online } };\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
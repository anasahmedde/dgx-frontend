{"ast":null,"code":"import axios from \"axios\";\n\n// Video API runs on port 8003\nconst BASE_URL = process.env.REACT_APP_VIDEO_API_URL || `${window.location.protocol}//${window.location.hostname}:8003`;\nconst api = axios.create({\n  baseURL: BASE_URL,\n  timeout: 30000,\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n});\nfunction normalizeList(payload) {\n  var _ref, _data$total;\n  const data = payload !== null && payload !== void 0 ? payload : {};\n  const items = Array.isArray(data) ? data : data.items || data.data || data.results || [];\n  const total = (_ref = (_data$total = data.total) !== null && _data$total !== void 0 ? _data$total : data.count) !== null && _ref !== void 0 ? _ref : items.length;\n  return {\n    items,\n    total\n  };\n}\nexport async function listVideos(limit = 100, offset = 0, q = \"\") {\n  try {\n    const params = {\n      limit,\n      offset\n    };\n    if (q) params.q = q;\n    const res = await api.get(\"/videos\", {\n      params\n    });\n    const {\n      items,\n      total\n    } = normalizeList(res.data);\n    return {\n      ok: true,\n      items,\n      total\n    };\n  } catch (err) {\n    console.error(\"listVideos error:\", err);\n    return {\n      ok: false,\n      items: [],\n      total: 0,\n      error: err.message\n    };\n  }\n}\n\n// Returns array of video names (for GroupLinkedVideo component)\nexport async function listVideoNames(limit = 100, offset = 0) {\n  try {\n    const res = await listVideos(limit, offset);\n    // Extract just the names as an array\n    return (res.items || []).map(v => v.video_name || v.name || v).filter(Boolean);\n  } catch (err) {\n    console.error(\"listVideoNames error:\", err);\n    return [];\n  }\n}\n\n// Upload video\nexport async function uploadVideo(formData, onProgress) {\n  try {\n    const res = await api.post(\"/upload_video\", formData, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      },\n      timeout: 300000,\n      onUploadProgress: progressEvent => {\n        if (onProgress && progressEvent.total) {\n          const percent = Math.round(progressEvent.loaded * 100 / progressEvent.total);\n          onProgress(percent);\n        }\n      }\n    });\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    var _err$response, _err$response$data;\n    console.error(\"uploadVideo error:\", err);\n    return {\n      ok: false,\n      error: ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || err.message\n    };\n  }\n}\n\n// DELETE video\nexport async function deleteVideo(videoId) {\n  try {\n    const res = await api.delete(`/videos/${videoId}`);\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    var _err$response2, _err$response2$data;\n    console.error(\"deleteVideo error:\", err);\n    return {\n      ok: false,\n      error: ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.detail) || err.message\n    };\n  }\n}\n\n// INSERT video (if your API supports it)\nexport async function insertVideo(videoData) {\n  try {\n    const res = await api.post(\"/videos\", videoData);\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    var _err$response3, _err$response3$data;\n    console.error(\"insertVideo error:\", err);\n    return {\n      ok: false,\n      error: ((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.detail) || err.message\n    };\n  }\n}\n\n// UPDATE video\nexport async function updateVideo(videoId, videoData) {\n  try {\n    const res = await api.put(`/videos/${videoId}`, videoData);\n    return {\n      ok: true,\n      data: res.data\n    };\n  } catch (err) {\n    var _err$response4, _err$response4$data;\n    console.error(\"updateVideo error:\", err);\n    return {\n      ok: false,\n      error: ((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.detail) || err.message\n    };\n  }\n}","map":{"version":3,"names":["axios","BASE_URL","process","env","REACT_APP_VIDEO_API_URL","window","location","protocol","hostname","api","create","baseURL","timeout","headers","normalizeList","payload","_ref","_data$total","data","items","Array","isArray","results","total","count","length","listVideos","limit","offset","q","params","res","get","ok","err","console","error","message","listVideoNames","map","v","video_name","name","filter","Boolean","uploadVideo","formData","onProgress","post","onUploadProgress","progressEvent","percent","Math","round","loaded","_err$response","_err$response$data","response","detail","deleteVideo","videoId","delete","_err$response2","_err$response2$data","insertVideo","videoData","_err$response3","_err$response3$data","updateVideo","put","_err$response4","_err$response4$data"],"sources":["/home/ubuntu/loadboard/react-video/src/api/video.js"],"sourcesContent":["import axios from \"axios\";\n\n// Video API runs on port 8003\nconst BASE_URL = process.env.REACT_APP_VIDEO_API_URL || \n  `${window.location.protocol}//${window.location.hostname}:8003`;\n\nconst api = axios.create({\n  baseURL: BASE_URL,\n  timeout: 30000,\n  headers: { \"Content-Type\": \"application/json\" },\n});\n\nfunction normalizeList(payload) {\n  const data = payload ?? {};\n  const items = Array.isArray(data) ? data : data.items || data.data || data.results || [];\n  const total = data.total ?? data.count ?? items.length;\n  return { items, total };\n}\n\nexport async function listVideos(limit = 100, offset = 0, q = \"\") {\n  try {\n    const params = { limit, offset };\n    if (q) params.q = q;\n    const res = await api.get(\"/videos\", { params });\n    const { items, total } = normalizeList(res.data);\n    return { ok: true, items, total };\n  } catch (err) {\n    console.error(\"listVideos error:\", err);\n    return { ok: false, items: [], total: 0, error: err.message };\n  }\n}\n\n// Returns array of video names (for GroupLinkedVideo component)\nexport async function listVideoNames(limit = 100, offset = 0) {\n  try {\n    const res = await listVideos(limit, offset);\n    // Extract just the names as an array\n    return (res.items || []).map(v => v.video_name || v.name || v).filter(Boolean);\n  } catch (err) {\n    console.error(\"listVideoNames error:\", err);\n    return [];\n  }\n}\n\n// Upload video\nexport async function uploadVideo(formData, onProgress) {\n  try {\n    const res = await api.post(\"/upload_video\", formData, {\n      headers: { \"Content-Type\": \"multipart/form-data\" },\n      timeout: 300000,\n      onUploadProgress: (progressEvent) => {\n        if (onProgress && progressEvent.total) {\n          const percent = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n          onProgress(percent);\n        }\n      },\n    });\n    return { ok: true, data: res.data };\n  } catch (err) {\n    console.error(\"uploadVideo error:\", err);\n    return { ok: false, error: err.response?.data?.detail || err.message };\n  }\n}\n\n// DELETE video\nexport async function deleteVideo(videoId) {\n  try {\n    const res = await api.delete(`/videos/${videoId}`);\n    return { ok: true, data: res.data };\n  } catch (err) {\n    console.error(\"deleteVideo error:\", err);\n    return { ok: false, error: err.response?.data?.detail || err.message };\n  }\n}\n\n// INSERT video (if your API supports it)\nexport async function insertVideo(videoData) {\n  try {\n    const res = await api.post(\"/videos\", videoData);\n    return { ok: true, data: res.data };\n  } catch (err) {\n    console.error(\"insertVideo error:\", err);\n    return { ok: false, error: err.response?.data?.detail || err.message };\n  }\n}\n\n// UPDATE video\nexport async function updateVideo(videoId, videoData) {\n  try {\n    const res = await api.put(`/videos/${videoId}`, videoData);\n    return { ok: true, data: res.data };\n  } catch (err) {\n    console.error(\"updateVideo error:\", err);\n    return { ok: false, error: err.response?.data?.detail || err.message };\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}